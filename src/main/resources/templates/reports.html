<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reports - Seating Arrangement System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
        }
        body {
            background-color: #f8f9fa;
        }
        .navbar {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            margin-bottom: 20px;
        }
        .card-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            border-radius: 15px 15px 0 0 !important;
            font-weight: 600;
        }
        .table-responsive {
            border-radius: 10px;
        }
        .room-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .seat-table {
            width: 100%;
        }
        .seat-table th {
            background-color: var(--primary-color);
            color: white;
            text-align: center;
            padding: 8px;
        }
        .seat-table td {
            text-align: center;
            padding: 6px;
            border: 1px solid #dee2e6;
        }
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            border: none;
        }
        .subject-column {
            display: table-cell;
        }
        .subject-column.hidden {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-dark mb-4">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1">
                <i class="fas fa-chair"></i> Seating Arrangement Reports
            </span>
            <div>
                <a href="/dashboard" class="btn btn-light btn-sm me-2">
                    <i class="fas fa-arrow-left"></i> Back to Dashboard
                </a>
                <form th:action="@{/logout}" method="post" class="d-inline">
                    <button type="submit" class="btn btn-outline-light btn-sm">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </form>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Date Selection -->
        <div class="card mb-4">
            <div class="card-header">
                <i class="fas fa-calendar"></i> Select Arrangement Date
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <select class="form-select" id="arrangementDate" onchange="loadReports()">
                            <option value="">Select a date...</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings -->
        <div class="card mb-4">
            <div class="card-header">
                <i class="fas fa-cog"></i> Settings
            </div>
            <div class="card-body">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="showSubjectCheckbox" checked onchange="toggleSubjectColumn()">
                    <label class="form-check-label" for="showSubjectCheckbox">
                        Show Subject Column
                    </label>
                </div>
            </div>
        </div>

        <!-- Report Tabs -->
        <ul class="nav nav-tabs mb-4" id="reportTabs" role="tablist" style="display:none;">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="consolidated-tab" data-bs-toggle="tab"
                        data-bs-target="#consolidated" type="button" role="tab">
                    <i class="fas fa-table"></i> Consolidated Report
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="rooms-tab" data-bs-toggle="tab"
                        data-bs-target="#rooms" type="button" role="tab">
                    <i class="fas fa-door-open"></i> Individual Room Reports
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="junior-supervisor-tab" data-bs-toggle="tab"
                        data-bs-target="#juniorSupervisor" type="button" role="tab">
                    <i class="fas fa-clipboard-list"></i> Junior Supervisor Reports
                </button>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="reportTabContent">
            <!-- Consolidated Report -->
            <div class="tab-pane fade show active" id="consolidated" role="tabpanel">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <span><i class="fas fa-file-alt"></i> Consolidated Report</span>
                        <button class="btn btn-light btn-sm" onclick="downloadConsolidatedPdf()" id="downloadConsolidatedBtn" style="display:none;">
                            <i class="fas fa-file-pdf"></i> Download PDF
                        </button>
                    </div>
                    <div class="card-body">
                        <!-- College Header -->
                        <div class="text-center mb-3" id="consolidatedHeader" style="display:none;">
                            <h5 class="mb-0" style="font-weight: bold;" th:text="${reportHeaderLine1}"></h5>
                            <h6 style="font-weight: bold;" th:text="${reportHeaderLine2}"></h6>
                            <h5 class="mt-2"><strong>Consolidated Report</strong></h5>
                        </div>
                        <div class="table-responsive">
                            <table class="table table-striped table-hover" id="consolidatedTable">
                                <thead>
                                    <tr>
                                        <th>Room No</th>
                                        <th>Department</th>
                                        <th>Roll No From</th>
                                        <th>Roll No To</th>
                                        <th>Total Count</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Individual Room Reports -->
            <div class="tab-pane fade" id="rooms" role="tabpanel">
                <div class="d-flex justify-content-between align-items-center mb-3" id="roomReportsHeader" style="display:none;">
                    <h5 class="mb-0">Individual Room Reports</h5>
                    <button class="btn btn-primary" onclick="downloadAllRoomsPdf()">
                        <i class="fas fa-file-pdf"></i> Download All PDFs (Merged)
                    </button>
                </div>
                <div id="roomReports"></div>
            </div>

            <!-- Junior Supervisor Reports -->
            <div class="tab-pane fade" id="juniorSupervisor" role="tabpanel">
                <div class="card mb-3">
                    <div class="card-header">
                        <i class="fas fa-cog"></i> Junior Supervisor Report Settings
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="showAnswerSheetCol" checked>
                                    <label class="form-check-label" for="showAnswerSheetCol">
                                        Show Main Answer Sheet No. Column
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="showSupplementsCol" checked>
                                    <label class="form-check-label" for="showSupplementsCol">
                                        Show No. of Supplements & Stationery Column
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="d-flex justify-content-between align-items-center mb-3" id="juniorSupervisorHeader" style="display:none;">
                    <h5 class="mb-0">Junior Supervisor Reports (Subject-wise, Room-wise)</h5>
                    <button class="btn btn-primary" onclick="downloadAllJuniorSupervisorPdfs()">
                        <i class="fas fa-file-pdf"></i> Download All PDFs (Merged)
                    </button>
                </div>
                <div id="juniorSupervisorReports"></div>
            </div>
        </div>
    </div>

    <!-- PDF Preview Modal -->
    <div class="modal fade" id="pdfPreviewModal" tabindex="-1" aria-labelledby="pdfPreviewModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="pdfPreviewModalLabel">PDF Preview</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3 d-flex justify-content-between align-items-center">
                        <div>
                            <label class="form-label mb-0 me-2"><strong>Font Size (pt):</strong></label>
                            <div class="input-group input-group-sm" style="width:160px;">
                                <button class="btn btn-outline-primary" type="button" id="fontDecrease">-</button>
                                <input type="text" id="fontSizeInput" class="form-control text-center" value="10" readonly>
                                <button class="btn btn-outline-primary" type="button" id="fontIncrease">+</button>
                            </div>
                            <button class="btn btn-sm btn-secondary ms-3" id="refreshPreviewBtn" type="button">
                                <i class="fas fa-sync"></i> Refresh Preview
                            </button>
                        </div>
                        <div id="pdfNavigation" style="display: none;">
                            <button class="btn btn-sm btn-outline-secondary" onclick="previousPage()">
                                <i class="fas fa-chevron-left"></i> Previous
                            </button>
                            <span class="mx-2">Page <span id="pageNum">1</span> of <span id="pageCount">1</span></span>
                            <button class="btn btn-sm btn-outline-secondary" onclick="nextPage()">
                                Next <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                    <div class="border rounded p-3 bg-light" style="height: 600px; overflow: auto;" id="pdfContainer">
                        <div class="d-flex justify-content-center align-items-center" style="min-height: 550px;">
                            <div class="text-center">
                                <div class="spinner-border text-primary" role="status">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                                <p class="mt-2">Loading PDF preview...</p>
                            </div>
                        </div>
                        <canvas id="pdfCanvas" style="display: none;"></canvas>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="confirmDownload()">
                        <i class="fas fa-download"></i> Download PDF
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script th:inline="javascript">
        // Configure PDF.js worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        // Report header configuration from server
        const reportHeaderLine1 = /*[[${reportHeaderLine1}]]*/ '';
        const reportHeaderLine2 = /*[[${reportHeaderLine2}]]*/ '';

        let currentPdfType = null; // 'consolidated', 'room', 'all-rooms'
        let currentPdfParams = {};
        let pdfModal = null;
        let pdfDoc = null;
        let currentPage = 1;
        let totalPages = 0;
        let rendering = false;

        $(document).ready(function() {
            loadDates();
            pdfModal = new bootstrap.Modal(document.getElementById('pdfPreviewModal'));
        });

        function loadDates() {
            $.get('/api/seating/dates', function(dates) {
                let options = '<option value="">Select a date...</option>';
                dates.forEach(date => {
                    options += `<option value="${date}">${date}</option>`;
                });
                $('#arrangementDate').html(options);

                if (dates.length > 0) {
                    $('#arrangementDate').val(dates[0]);
                    loadReports();
                }
            });
        }

        function loadReports() {
            let date = $('#arrangementDate').val();
            if (!date) {
                $('#reportTabs').hide();
                return;
            }

            $('#reportTabs').show();
            loadConsolidatedReport(date);
            loadRoomReports(date);
            loadJuniorSupervisorReports(date);
        }

        function loadConsolidatedReport(date) {
            $.get(`/api/seating/reports/consolidated?date=${date}`, function(data) {
                let tbody = '';
                data.forEach(row => {
                    tbody += `<tr>
                        <td>${row.roomNo}</td>
                        <td>${row.department}</td>
                        <td>${row.rollNoFrom}</td>
                        <td>${row.rollNoTo}</td>
                        <td><strong>${row.totalCount}</strong></td>
                    </tr>`;
                });
                $('#consolidatedTable tbody').html(tbody);
                $('#consolidatedHeader').show();
                $('#downloadConsolidatedBtn').show();
            });
        }

        function loadRoomReports(date) {
            $.get(`/api/seating/reports/rooms?date=${date}`, function(reports) {
                let html = '';
                reports.forEach(room => {
                    html += `
                        <div class="room-card">
                            <!-- College Header -->
                            <div class="text-center mb-3">
                                <h5 class="mb-0" style="font-weight: bold;">${reportHeaderLine1}</h5>
                                <h6 style="font-weight: bold;">${reportHeaderLine2}</h6>
                                <h5 class="mt-2"><strong>Individual Room Report</strong></h5>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <div>
                                    <h4>Room: ${room.roomNo}</h4>
                                    <p class="mb-0"><strong>Departments:</strong> ${Array.from(room.departments).join(', ')}</p>
                                    <p class="mb-0"><strong>Subjects:</strong> ${Array.from(room.subjects).join(', ')}</p>
                                </div>
                                <button class="btn btn-primary" onclick="downloadPdf('${room.roomNo}', '${date}')">
                                    <i class="fas fa-file-pdf"></i> Download PDF
                                </button>
                            </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <h6 class="text-center">Right Seats (R)</h6>
                                    <table class="seat-table table table-bordered table-sm">
                                        <thead>
                                            <tr>
                                                <th>Seat</th>
                                                <th>Roll No</th>
                                                <th class="subject-column">Subject</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            ${generateSeatRows(room.rightSeats)}
                                        </tbody>
                                    </table>
                                </div>
                                <div class="col-md-4">
                                    <h6 class="text-center">Middle Seats (M)</h6>
                                    <table class="seat-table table table-bordered table-sm">
                                        <thead>
                                            <tr>
                                                <th>Seat</th>
                                                <th>Roll No</th>
                                                <th class="subject-column">Subject</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            ${generateSeatRows(room.middleSeats)}
                                        </tbody>
                                    </table>
                                </div>
                                <div class="col-md-4">
                                    <h6 class="text-center">Left Seats (L)</h6>
                                    <table class="seat-table table table-bordered table-sm">
                                        <thead>
                                            <tr>
                                                <th>Seat</th>
                                                <th>Roll No</th>
                                                <th class="subject-column">Subject</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            ${generateSeatRows(room.leftSeats)}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    `;
                });
                $('#roomReports').html(html);
                $('#roomReportsHeader').show();
            });
        }

        function loadJuniorSupervisorReports(date) {
            $.get(`/api/seating/reports/junior-supervisor?date=${date}`, function(reports) {
                let html = '';
                // Group by room
                let groupedByRoom = {};
                reports.forEach(report => {
                    if (!groupedByRoom[report.roomNo]) {
                        groupedByRoom[report.roomNo] = [];
                    }
                    groupedByRoom[report.roomNo].push(report);
                });

                for (let roomNo in groupedByRoom) {
                    let roomReports = groupedByRoom[roomNo];
                    html += `
                        <div class="room-card">
                            <h4 class="mb-3">Room: ${roomNo}</h4>
                            <div class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <thead>
                                        <tr>
                                            <th>Subject</th>
                                            <th>Department</th>
                                            <th>Class</th>
                                            <th>Total Students</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                    `;

                    roomReports.forEach(report => {
                        let escapedSubject = report.subject.replace(/'/g, "\\'");
                        html += `
                            <tr>
                                <td>${report.subject}</td>
                                <td>${report.department}</td>
                                <td>${report.className}</td>
                                <td><strong>${report.totalStudents}</strong></td>
                                <td>
                                    <button class="btn btn-sm btn-primary" onclick="downloadJuniorSupervisorPdf('${roomNo}', '${escapedSubject}', '${date}')">
                                        <i class="fas fa-file-pdf"></i> Download PDF
                                    </button>
                                </td>
                            </tr>
                        `;
                    });

                    html += `
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    `;
                }

                $('#juniorSupervisorReports').html(html);
                $('#juniorSupervisorHeader').show();
            });
        }

        function downloadJuniorSupervisorPdf(roomNo, subject, date) {
            let showAnswerSheetCol = $('#showAnswerSheetCol').is(':checked');
            let showSupplementsCol = $('#showSupplementsCol').is(':checked');

            let url = `/api/seating/reports/junior-supervisor/pdf?roomNo=${encodeURIComponent(roomNo)}&subject=${encodeURIComponent(subject)}&date=${date}&fontSize=10&showAnswerSheetCol=${showAnswerSheetCol}&showSupplementsCol=${showSupplementsCol}`;

            const a = document.createElement('a');
            a.href = url;
            a.download = '';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        function downloadAllJuniorSupervisorPdfs() {
            let date = $('#arrangementDate').val();
            if (!date) {
                alert('Please select a date first');
                return;
            }

            let showAnswerSheetCol = $('#showAnswerSheetCol').is(':checked');
            let showSupplementsCol = $('#showSupplementsCol').is(':checked');

            let url = `/api/seating/reports/junior-supervisor/all/pdf?date=${date}&fontSize=10&showAnswerSheetCol=${showAnswerSheetCol}&showSupplementsCol=${showSupplementsCol}`;

            const a = document.createElement('a');
            a.href = url;
            a.download = '';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        function generateSeatRows(seats) {
            if (!seats || seats.length === 0) {
                return '<tr><td colspan="3">No seats</td></tr>';
            }
            return seats.map(seat => `
                <tr>
                    <td>${seat.seatNo}</td>
                    <td>${seat.rollNo}</td>
                    <td class="subject-column"><small>${seat.subject}</small></td>
                </tr>
            `).join('');
        }

        function toggleSubjectColumn() {
            const showSubject = $('#showSubjectCheckbox').is(':checked');
            const subjectColumns = $('.subject-column');

            if (showSubject) {
                subjectColumns.removeClass('hidden');
            } else {
                subjectColumns.addClass('hidden');
            }
        }

        function downloadPdf(roomNo, date) {
            currentPdfType = 'room';
            currentPdfParams = { roomNo: roomNo, date: date };
            openPreviewModal();
        }

        function downloadConsolidatedPdf() {
            let date = $('#arrangementDate').val();
            if (!date) {
                alert('Please select a date first');
                return;
            }
            currentPdfType = 'consolidated';
            currentPdfParams = { date: date };
            openPreviewModal();
        }

        function downloadAllRoomsPdf() {
            let date = $('#arrangementDate').val();
            if (!date) {
                alert('Please select a date first');
                return;
            }
            currentPdfType = 'all-rooms';
            currentPdfParams = { date: date };
            openPreviewModal();
        }

        function openPreviewModal() {
            // Reset to 10pt font size
            $('#fontSizeInput').val(10);
            currentPage = 1;

            // Show modal first
            pdfModal.show();

            // Load preview
            refreshPreview();
        }

        // Font size controls (+/-) and refresh handler
        $('#fontIncrease').on('click', function() {
            let v = parseInt($('#fontSizeInput').val(), 10) || 10;
            if (v < 72) {
                $('#fontSizeInput').val(v + 1);
                if (pdfModal) refreshPreview();
            }
        });
        $('#fontDecrease').on('click', function() {
            let v = parseInt($('#fontSizeInput').val(), 10) || 10;
            if (v > 6) {
                $('#fontSizeInput').val(v - 1);
                if (pdfModal) refreshPreview();
            }
        });
        $('#refreshPreviewBtn').on('click', function() { refreshPreview(); });

        function refreshPreview() {
            let fontSize = parseInt($('#fontSizeInput').val(), 10) || 10;
            let url = buildPdfUrl(fontSize);

            // Show loading state
            $('#pdfContainer').html(`
                <div class="d-flex justify-content-center align-items-center" style="min-height: 550px;">
                    <div class="text-center">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p class="mt-2">Loading PDF preview...</p>
                    </div>
                </div>
            `);

            // Hide page navigation - using continuous scroll
            $('#pdfNavigation').hide();

            // Load PDF using PDF.js
            fetch(url)
                .then(response => response.arrayBuffer())
                .then(data => pdfjsLib.getDocument({data: data}).promise)
                .then(pdf => {
                    pdfDoc = pdf;
                    totalPages = pdf.numPages;

                    // Clear container for rendered pages
                    $('#pdfContainer').empty();

                    // Render all pages for continuous scroll
                    const renderPromises = [];
                    for (let p = 1; p <= totalPages; p++) {
                        renderPromises.push(renderPageToCanvas(p, fontSize));
                    }

                    return Promise.all(renderPromises).then(() => {
                        // update page info
                        $('#pageCount').text(totalPages);
                        $('#pageNum').text(1);
                    });
                })
                .catch(error => {
                    console.error('Error loading PDF:', error);
                    $('#pdfContainer').html(`
                        <div class="alert alert-danger">
                            <i class="fas fa-exclamation-triangle"></i> Error loading PDF preview
                        </div>
                    `);
                });
        }

        // Render a specific page into its own canvas and append to container (for continuous scroll)
        function renderPageToCanvas(pageNumber, fontSize) {
            return pdfDoc.getPage(pageNumber).then(page => {
                // scale viewport based on font size so preview reflects chosen font
                const baseScale = 1.5; // default scale for 10pt
                const scale = baseScale * (fontSize / 10);
                const viewport = page.getViewport({scale: scale});

                const canvas = document.createElement('canvas');
                canvas.style.display = 'block';
                canvas.style.margin = '10px auto';
                canvas.width = viewport.width;
                canvas.height = viewport.height;

                const context = canvas.getContext('2d');
                const renderContext = {
                    canvasContext: context,
                    viewport: viewport
                };

                // Add a wrapper to show page number label if needed
                const wrapper = document.createElement('div');
                wrapper.className = 'pdf-page-wrapper';
                wrapper.style.textAlign = 'center';
                wrapper.appendChild(canvas);

                $('#pdfContainer').append(wrapper);

                return page.render(renderContext).promise.then(() => {
                    // nothing else per page
                });
            });
        }

        // Keep previous/next for compatibility but hide navigation in continuous mode
        function previousPage() { /* not used in continuous scroll */ }
        function nextPage() { /* not used in continuous scroll */ }

        function buildPdfUrl(fontSize) {
            let url = '';
            let params = new URLSearchParams();

            if (currentPdfType === 'consolidated') {
                url = '/api/seating/reports/consolidated/pdf';
                params.append('date', currentPdfParams.date);
            } else if (currentPdfType === 'room') {
                url = '/api/seating/reports/room/pdf';
                params.append('roomNo', currentPdfParams.roomNo);
                params.append('date', currentPdfParams.date);
            } else if (currentPdfType === 'all-rooms') {
                url = '/api/seating/reports/all-rooms/pdf';
                params.append('date', currentPdfParams.date);
            }

            params.append('fontSize', fontSize);

            return url + '?' + params.toString();
        }

        function confirmDownload() {
            let fontSize = $('#fontSizeInput').val() || 10;
            let url = buildPdfUrl(fontSize);

            // Create a temporary anchor element to trigger download
            const a = document.createElement('a');
            a.href = url;
            a.download = '';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);

            // Close modal
            pdfModal.hide();
        }
    </script>
</body>
</html>
